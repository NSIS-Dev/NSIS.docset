<!DOCTYPE html><html lang="en"><!-- Online page at https://idleberg.github.io/NSIS.docset/Contents/Resources/Documents/html/Plugins/nsExec.html --><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta name="generator" content="nsis-docset-builder v0.5.2"><title>nsExec | Core</title><link rel="stylesheet" href="../../css/docset.min.css"></head><body class="hljs-dark"><div class="container"><div class="row"><div class="col-xs-12"><h1 id="nsexec">nsExec</h1><p>nsExec will execute command-line based programs and capture the output without opening a DOS box.</p><h2 id="usage">Usage</h2><pre><code>nsExec::Exec [/OEM] [/TIMEOUT=x] path
Pop $0

nsExec::ExecToLog [/OEM] [/TIMEOUT=x] path
Pop $0

nsExec::ExecToStack [/OEM] [/TIMEOUT=x] path
Pop $0 ; Return
Pop $1 ; Output
</code></pre><p>All functions are the same except <code>ExecToLog</code> will print the output to the log window and <code>ExecToStack</code> will push up to <code>${NSIS_MAX_STRLEN}</code> characters of output onto the stack after the return value.</p><p>Use the /OEM switch to convert the output text from OEM to ANSI.</p><p>The timeout value is optional. The timeout is the time in milliseconds `nsExec will wait for output. If output from the process is received, the timeout value is reset and it will again wait for more output using the timeout value. See Return Value for how to check if there was a timeout.</p><p>To ensure that command are executed without problems on all windows versions, is recommended to use the following syntax:</p><pre><code>nsExec::ExecToStack [OPTIONS] &#39;&quot;PATH&quot; param1 param2 paramN&#39;
</code></pre><p>This way the application path may contain non 8.3 paths (with spaces)</p><h4 id="return-value">Return Value</h4><p>If <code>nsExec</code> is unable to execute the process, it will return &quot;error&quot; on the top of the stack, if the process timed out it will return &quot;timeout&quot;, else it will return the return code from the executed process.</p><h2 id="credits">Credits</h2><p>Written by <a href="http://nsis.sourceforge.net/User:Kichik">Robert Rainwater</a>. Thanks to Justin Frankel and [Amir Szekely][3].</p></div><div class="col-xs-12 text-right"><hr><a href="https://github.com/NSIS-Dev/Documentation/edit/master/Plugins/nsExec.md" class="btn btn-sm btn-default"><i class="fa fa-lg fa-edit"></i> Edit on GitHub</a></div></div></div><script src="../../js/highlight.min.js" type="text/javascript"></script><script>hljs.initHighlightingOnLoad();</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53539506-20"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-53539506-20");</script></body></html>