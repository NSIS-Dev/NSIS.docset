<!DOCTYPE html><html lang="en"><!-- Online page at https://idleberg.github.io/NSIS.docset/Contents/Resources/Documents/html/Reference/GetKnownFolderPath.html --><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta name="generator" content="nsis-docset-builder v0.5.2"><title>GetKnownFolderPath | Core</title><link rel="stylesheet" href="../../css/docset.min.css"></head><body class="hljs-dark"><div class="container"><div class="row"><div class="col-xs-12"><h1 id="getknownfolderpath">GetKnownFolderPath</h1><p>Get the path of a [known folder](Get the path of a known folder. The error flag is set and the output variable is empty if the call fails or the <code>knownfolderid</code> guid is not available. This function is only able to resolve known folders on Windows Vista or higher.). The error flag is set and the output variable is empty if the call fails or the <code>knownfolderid</code> guid is not available. This function is only able to resolve known folders on Windows Vista or higher.</p><h2 id="parameters">Parameters</h2><pre><code>user_var(output) knownfolderid</code></pre><h2 id="example">Example</h2><pre><code>!include WinCore.nsh
!include LogicLib.nsh

Function .onInit
    ${If} $InstDir == &quot;&quot;
        GetKnownFolderPath $InstDir ${FOLDERID_UserProgramFiles} ; This exists on Win7+
        StrCmp $InstDir &quot;&quot; 0 +2 
        StrCpy $InstDir &quot;$LocalAppData\Programs&quot; ; Fallback directory
        StrCpy $InstDir &quot;$InstDir\$(^Name)&quot;
    ${EndIf}
FunctionEnd</code></pre><h2 id="history">History</h2><p>Added in NSIS v3.06</p></div><div class="col-xs-12 text-right"><hr><a href="https://github.com/NSIS-Dev/Documentation/edit/master/Reference/GetKnownFolderPath.md" class="btn btn-sm btn-default"><i class="fa fa-lg fa-edit"></i> Edit on GitHub</a></div></div></div><script src="../../js/highlight.min.js" type="text/javascript"></script><script>hljs.initHighlightingOnLoad();</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53539506-20"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-53539506-20");</script></body></html>